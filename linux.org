#+TITLE: dotfiles for Linux
#+OPTIONS: toc:nil num:nil
#+STARTUP: showall

In addition to the base =README.org= file, this document describes and
creates Linux specific configuration.

* =.console-setup=
  :PROPERTIES:
  :header-args: :tangle ~/.console-setup
  :END:

  This is currently empty but needs to exist for =.keyboard= to be
  read properly.

  #+BEGIN_SRC sh
  #+END_SRC

* =.keyboard=
  :PROPERTIES:
  :header-args: :tangle ~/.keyboard
  :END:

  #+BEGIN_SRC sh
    XKBOPTIONS="ctrl:swapcaps"
  #+END_SRC

* TODO =xrandr=

  https://gist.github.com/ryanpcmcquen/14adac20e6dd57a51b96

* =.config=

** =redshift/redshift.conf=
   :PROPERTIES:
   :header-args: :tangle ~/.config/redshift/refshift.conf
   :END:

   [[https://github.com/jonls/redshift][Redshift]] is a nice blue light filter.

   - Configure with user service =./configure --with-systemduserunitdir=$HOME/.config/systemd/user=
   - =TODO= Fix [[https://bbs.archlinux.org/viewtopic.php?id=177473][user service issue]]

   #+BEGIN_SRC conf
     ; Global settings for redshift
     [redshift]
     ; Set the day and night screen temperatures
     temp-day=5700
     temp-night=3500

     ; Disable the smooth fade between temperatures when Redshift starts and stops.
     ; 0 will cause an immediate change between screen temperatures.
     ; 1 will gradually apply the new screen temperature over a couple of seconds.
     fade=1

     ; Solar elevation thresholds.
     ; By default, Redshift will use the current elevation of the sun to determine
     ; whether it is daytime, night or in transition (dawn/dusk). When the sun is
     ; above the degrees specified with elevation-high it is considered daytime and
     ; below elevation-low it is considered night.
     ;elevation-high=3
     ;elevation-low=-6

     ; Custom dawn/dusk intervals.
     ; Instead of using the solar elevation, the time intervals of dawn and dusk
     ; can be specified manually. The times must be specified as HH:MM in 24-hour
     ; format.
     ;dawn-time=6:00-7:45
     ;dusk-time=18:35-20:15

     ; Set the screen brightness. Default is 1.0.
     ;brightness=0.9
     ; It is also possible to use different settings for day and night
     ; since version 1.8.
     ;brightness-day=0.7
     ;brightness-night=0.4
     ; Set the screen gamma (for all colors, or each color channel
     ; individually)
     gamma=0.8
     ;gamma=0.8:0.7:0.8
     ; This can also be set individually for day and night since
     ; version 1.10.
     ;gamma-day=0.8:0.7:0.8
     ;gamma-night=0.6

     ; Set the location-provider: 'geoclue2', 'manual'
     ; type 'redshift -l list' to see possible values.
     ; The location provider settings are in a different section.
     location-provider=manual

     ; Set the adjustment-method: 'randr', 'vidmode'
     ; type 'redshift -m list' to see all possible values.
     ; 'randr' is the preferred method, 'vidmode' is an older API.
     ; but works in some cases when 'randr' does not.
     ; The adjustment method settings are in a different section.
     adjustment-method=Rand

     ; Configuration of the location-provider:
     ; type 'redshift -l PROVIDER:help' to see the settings.
     ; ex: 'redshift -l manual:help'
     ; Keep in mind that longitudes west of Greenwich (e.g. the Americas)
     ; are negative numbers.
     [manual]
     lat=40
     lon=-75.7

     ; Configuration of the adjustment-method
     ; type 'redshift -m METHOD:help' to see the settings.
     ; ex: 'redshift -m randr:help'
     ; In this example, randr is configured to adjust only screen 0.
     ; Note that the numbering starts from 0, so this is actually the first screen.
     ; If this option is not specified, Redshift will try to adjust _all_ screens.
     [randr]
     screen=0
   #+END_SRC

* =.dwm=
  :PROPERTIES:
  :header-args: :tangle ~/.dwm/autostart.sh
  :END:

  TODO make sure that the tangled file has executable bit set!

  This depends on the [[https://dwm.suckless.org/patches/autostart/][autostart]] patch!

  Prerequisite:

  #+BEGIN_SRC sh
    mkdir -p ~/.dwm/
  #+END_SRC

  Caps Lock, GTFO of my keyboard.  Very specifically run =xmodmap=
  /after/ =setxkbmap= to make sure that this sticks.  I want to blame
  Ubuntu and then Gnome for this but I don't have enough time right
  now to properly assign blame and then help to fix it.

  #+BEGIN_SRC sh
    #!/usr/bin/env bash

    setxkbmap -option caps:ctrl_modifier
    [[ -f ~/.Xmodmap ]] && xmodmap ~/.Xmodmap
    st &
  #+END_SRC

* =.Xmodmap=
  :PROPERTIES:
  :header-args: :tangle ~/.Xmodmap
  :END:

  [2019-12-27 Fri]

  Apparently the =setxkbmap= suite of tooling now conflicts with
  =xmodmap= in mysterious ways and it's a tire fire of mappings.
  Remapping keys should be easy but having at least two different ways
  to remap keys makes it difficult at best.

  Previously:

  Dumped first from =xmodmap -pke > ~/.Xmodmap=, then added [[https://wiki.archlinux.org/index.php/xmodmap#Reverse_scrolling][natural
  scrolling]].

  #+BEGIN_SRC sh
    ! "Natural" scolling, i.e., inverse scroll
    pointer     = 1 2 3 5 4 7 6 8 9 10

    ! Map right Alt to Mod3 for dwm to avoid Emacs collision
    remove Mod1 = Alt_R
    add Mod3    = Alt_R

    keycode   8 =
    keycode   9 = Escape NoSymbol Escape
    keycode  10 = 1 exclam 1 exclam
    keycode  11 = 2 at 2 at
    keycode  12 = 3 numbersign 3 numbersign
    keycode  13 = 4 dollar 4 dollar
    keycode  14 = 5 percent 5 percent
    keycode  15 = 6 asciicircum 6 asciicircum dead_circumflex dead_circumflex dead_circumflex
    keycode  16 = 7 ampersand 7 ampersand
    keycode  17 = 8 asterisk 8 asterisk
    keycode  18 = 9 parenleft 9 parenleft dead_grave NoSymbol dead_grave
    keycode  19 = 0 parenright 0 parenright
    keycode  20 = bracketleft braceleft bracketleft braceleft
    keycode  21 = bracketright braceright bracketright braceright dead_tilde NoSymbol dead_tilde
    keycode  22 = BackSpace BackSpace BackSpace BackSpace
    keycode  23 = Tab ISO_Left_Tab Tab ISO_Left_Tab
    keycode  24 = apostrophe quotedbl apostrophe quotedbl dead_acute dead_diaeresis dead_acute
    keycode  25 = comma less comma less dead_cedilla dead_caron dead_cedilla
    keycode  26 = period greater period greater dead_abovedot periodcentered dead_abovedot
    keycode  27 = p P p P
    keycode  28 = y Y y Y
    keycode  29 = f F f F
    keycode  30 = g G g G
    keycode  31 = c C c C
    keycode  32 = r R r R
    keycode  33 = l L l L
    keycode  34 = slash question slash question
    keycode  35 = equal plus equal plus
    keycode  36 = Return NoSymbol Return
    keycode  37 = Caps_Lock NoSymbol Caps_Lock
    keycode  38 = a A a A
    keycode  39 = o O o O
    keycode  40 = e E e E
    keycode  41 = u U u U
    keycode  42 = i I i I
    keycode  43 = d D d D
    keycode  44 = h H h H
    keycode  45 = t T t T
    keycode  46 = n N n N
    keycode  47 = s S s S
    keycode  48 = minus underscore minus underscore
    keycode  49 = grave asciitilde grave asciitilde dead_grave dead_tilde dead_grave
    keycode  50 = Shift_L NoSymbol Shift_L
    keycode  51 = backslash bar backslash bar
    keycode  52 = semicolon colon semicolon colon dead_ogonek dead_doubleacute dead_ogonek
    keycode  53 = q Q q Q
    keycode  54 = j J j J
    keycode  55 = k K k K
    keycode  56 = x X x X
    keycode  57 = b B b B
    keycode  58 = m M m M
    keycode  59 = w W w W
    keycode  60 = v V v V
    keycode  61 = z Z z Z
    keycode  62 = Shift_R NoSymbol Shift_R
    keycode  63 = KP_Multiply KP_Multiply KP_Multiply KP_Multiply KP_Multiply KP_Multiply XF86ClearGrab
    keycode  64 = Alt_L Meta_L Alt_L Meta_L
    keycode  65 = space NoSymbol space
    keycode  66 = Control_L NoSymbol Control_L
    keycode  67 = F1 F1 F1 F1 F1 F1 XF86Switch_VT_1
    keycode  68 = F2 F2 F2 F2 F2 F2 XF86Switch_VT_2
    keycode  69 = F3 F3 F3 F3 F3 F3 XF86Switch_VT_3
    keycode  70 = F4 F4 F4 F4 F4 F4 XF86Switch_VT_4
    keycode  71 = F5 F5 F5 F5 F5 F5 XF86Switch_VT_5
    keycode  72 = F6 F6 F6 F6 F6 F6 XF86Switch_VT_6
    keycode  73 = F7 F7 F7 F7 F7 F7 XF86Switch_VT_7
    keycode  74 = F8 F8 F8 F8 F8 F8 XF86Switch_VT_8
    keycode  75 = F9 F9 F9 F9 F9 F9 XF86Switch_VT_9
    keycode  76 = F10 F10 F10 F10 F10 F10 XF86Switch_VT_10
    keycode  77 = Num_Lock NoSymbol Num_Lock
    keycode  78 = Scroll_Lock NoSymbol Scroll_Lock
    keycode  79 = KP_Home KP_7 KP_Home KP_7
    keycode  80 = KP_Up KP_8 KP_Up KP_8
    keycode  81 = KP_Prior KP_9 KP_Prior KP_9
    keycode  82 = KP_Subtract KP_Subtract KP_Subtract KP_Subtract KP_Subtract KP_Subtract XF86Prev_VMode
    keycode  83 = KP_Left KP_4 KP_Left KP_4
    keycode  84 = KP_Begin KP_5 KP_Begin KP_5
    keycode  85 = KP_Right KP_6 KP_Right KP_6
    keycode  86 = KP_Add KP_Add KP_Add KP_Add KP_Add KP_Add XF86Next_VMode
    keycode  87 = KP_End KP_1 KP_End KP_1
    keycode  88 = KP_Down KP_2 KP_Down KP_2
    keycode  89 = KP_Next KP_3 KP_Next KP_3
    keycode  90 = KP_Insert KP_0 KP_Insert KP_0
    keycode  91 = KP_Delete KP_Decimal KP_Delete KP_Decimal
    keycode  92 = ISO_Level3_Shift NoSymbol ISO_Level3_Shift
    keycode  93 =
    keycode  94 = less greater less greater bar brokenbar bar
    keycode  95 = F11 F11 F11 F11 F11 F11 XF86Switch_VT_11
    keycode  96 = F12 F12 F12 F12 F12 F12 XF86Switch_VT_12
    keycode  97 =
    keycode  98 = Katakana NoSymbol Katakana
    keycode  99 = Hiragana NoSymbol Hiragana
    keycode 100 = Henkan_Mode NoSymbol Henkan_Mode
    keycode 101 = Hiragana_Katakana NoSymbol Hiragana_Katakana
    keycode 102 = Muhenkan NoSymbol Muhenkan
    keycode 103 =
    keycode 104 = KP_Enter NoSymbol KP_Enter
    keycode 105 = Control_R NoSymbol Control_R
    keycode 106 = KP_Divide KP_Divide KP_Divide KP_Divide KP_Divide KP_Divide XF86Ungrab
    keycode 107 = Print Sys_Req Print Sys_Req
    keycode 108 = Alt_R Meta_R Alt_R Meta_R
    keycode 109 = Linefeed NoSymbol Linefeed
    keycode 110 = Home NoSymbol Home
    keycode 111 = Up NoSymbol Up
    keycode 112 = Prior NoSymbol Prior
    keycode 113 = Left NoSymbol Left
    keycode 114 = Right NoSymbol Right
    keycode 115 = End NoSymbol End
    keycode 116 = Down NoSymbol Down
    keycode 117 = Next NoSymbol Next
    keycode 118 = Insert NoSymbol Insert
    keycode 119 = Delete NoSymbol Delete
    keycode 120 =
    keycode 121 = XF86AudioMute NoSymbol XF86AudioMute
    keycode 122 = XF86AudioLowerVolume NoSymbol XF86AudioLowerVolume
    keycode 123 = XF86AudioRaiseVolume NoSymbol XF86AudioRaiseVolume
    keycode 124 = XF86PowerOff NoSymbol XF86PowerOff
    keycode 125 = KP_Equal NoSymbol KP_Equal
    keycode 126 = plusminus NoSymbol plusminus
    keycode 127 = Pause Break Pause Break
    keycode 128 = XF86LaunchA NoSymbol XF86LaunchA
    keycode 129 = KP_Decimal KP_Decimal KP_Decimal KP_Decimal
    keycode 130 = Hangul NoSymbol Hangul
    keycode 131 = Hangul_Hanja NoSymbol Hangul_Hanja
    keycode 132 =
    keycode 133 = Super_L NoSymbol Super_L
    keycode 134 = Super_R NoSymbol Super_R
    keycode 135 = Menu NoSymbol Menu
    keycode 136 = Cancel NoSymbol Cancel
    keycode 137 = Redo NoSymbol Redo
    keycode 138 = SunProps NoSymbol SunProps
    keycode 139 = Undo NoSymbol Undo
    keycode 140 = SunFront NoSymbol SunFront
    keycode 141 = XF86Copy NoSymbol XF86Copy
    keycode 142 = XF86Open NoSymbol XF86Open
    keycode 143 = XF86Paste NoSymbol XF86Paste
    keycode 144 = Find NoSymbol Find
    keycode 145 = XF86Cut NoSymbol XF86Cut
    keycode 146 = Help NoSymbol Help
    keycode 147 = XF86MenuKB NoSymbol XF86MenuKB
    keycode 148 = XF86Calculator NoSymbol XF86Calculator
    keycode 149 =
    keycode 150 = XF86Sleep NoSymbol XF86Sleep
    keycode 151 = XF86WakeUp NoSymbol XF86WakeUp
    keycode 152 = XF86Explorer NoSymbol XF86Explorer
    keycode 153 = XF86Send NoSymbol XF86Send
    keycode 154 =
    keycode 155 = XF86Xfer NoSymbol XF86Xfer
    keycode 156 = XF86Launch1 NoSymbol XF86Launch1
    keycode 157 = XF86Launch2 NoSymbol XF86Launch2
    keycode 158 = XF86WWW NoSymbol XF86WWW
    keycode 159 = XF86DOS NoSymbol XF86DOS
    keycode 160 = XF86ScreenSaver NoSymbol XF86ScreenSaver
    keycode 161 = XF86RotateWindows NoSymbol XF86RotateWindows
    keycode 162 = XF86TaskPane NoSymbol XF86TaskPane
    keycode 163 = XF86Mail NoSymbol XF86Mail
    keycode 164 = XF86Favorites NoSymbol XF86Favorites
    keycode 165 = XF86MyComputer NoSymbol XF86MyComputer
    keycode 166 = XF86Back NoSymbol XF86Back
    keycode 167 = XF86Forward NoSymbol XF86Forward
    keycode 168 =
    keycode 169 = XF86Eject NoSymbol XF86Eject
    keycode 170 = XF86Eject XF86Eject XF86Eject XF86Eject
    keycode 171 = XF86AudioNext NoSymbol XF86AudioNext
    keycode 172 = XF86AudioPlay XF86AudioPause XF86AudioPlay XF86AudioPause
    keycode 173 = XF86AudioPrev NoSymbol XF86AudioPrev
    keycode 174 = XF86AudioStop XF86Eject XF86AudioStop XF86Eject
    keycode 175 = XF86AudioRecord NoSymbol XF86AudioRecord
    keycode 176 = XF86AudioRewind NoSymbol XF86AudioRewind
    keycode 177 = XF86Phone NoSymbol XF86Phone
    keycode 178 =
    keycode 179 = XF86Tools NoSymbol XF86Tools
    keycode 180 = XF86HomePage NoSymbol XF86HomePage
    keycode 181 = XF86Reload NoSymbol XF86Reload
    keycode 182 = XF86Close NoSymbol XF86Close
    keycode 183 =
    keycode 184 =
    keycode 185 = XF86ScrollUp NoSymbol XF86ScrollUp
    keycode 186 = XF86ScrollDown NoSymbol XF86ScrollDown
    keycode 187 = parenleft NoSymbol parenleft
    keycode 188 = parenright NoSymbol parenright
    keycode 189 = XF86New NoSymbol XF86New
    keycode 190 = Redo NoSymbol Redo
    keycode 191 = XF86Tools NoSymbol XF86Tools
    keycode 192 = XF86Launch5 NoSymbol XF86Launch5
    keycode 193 = XF86Launch6 NoSymbol XF86Launch6
    keycode 194 = XF86Launch7 NoSymbol XF86Launch7
    keycode 195 = XF86Launch8 NoSymbol XF86Launch8
    keycode 196 = XF86Launch9 NoSymbol XF86Launch9
    keycode 197 =
    keycode 198 = XF86AudioMicMute NoSymbol XF86AudioMicMute
    keycode 199 = XF86TouchpadToggle NoSymbol XF86TouchpadToggle
    keycode 200 = XF86TouchpadOn NoSymbol XF86TouchpadOn
    keycode 201 = XF86TouchpadOff NoSymbol XF86TouchpadOff
    keycode 202 =
    keycode 203 = Mode_switch NoSymbol Mode_switch
    keycode 204 = NoSymbol Alt_L NoSymbol Alt_L
    keycode 205 = NoSymbol Meta_L NoSymbol Meta_L
    keycode 206 = NoSymbol Super_L NoSymbol Super_L
    keycode 207 = NoSymbol Hyper_L NoSymbol Hyper_L
    keycode 208 = XF86AudioPlay NoSymbol XF86AudioPlay
    keycode 209 = XF86AudioPause NoSymbol XF86AudioPause
    keycode 210 = XF86Launch3 NoSymbol XF86Launch3
    keycode 211 = XF86Launch4 NoSymbol XF86Launch4
    keycode 212 = XF86LaunchB NoSymbol XF86LaunchB
    keycode 213 = XF86Suspend NoSymbol XF86Suspend
    keycode 214 = XF86Close NoSymbol XF86Close
    keycode 215 = XF86AudioPlay NoSymbol XF86AudioPlay
    keycode 216 = XF86AudioForward NoSymbol XF86AudioForward
    keycode 217 =
    keycode 218 = Print NoSymbol Print
    keycode 219 =
    keycode 220 = XF86WebCam NoSymbol XF86WebCam
    keycode 221 =
    keycode 222 =
    keycode 223 = XF86Mail NoSymbol XF86Mail
    keycode 224 = XF86Messenger NoSymbol XF86Messenger
    keycode 225 = XF86Search NoSymbol XF86Search
    keycode 226 = XF86Go NoSymbol XF86Go
    keycode 227 = XF86Finance NoSymbol XF86Finance
    keycode 228 = XF86Game NoSymbol XF86Game
    keycode 229 = XF86Shop NoSymbol XF86Shop
    keycode 230 =
    keycode 231 = Cancel NoSymbol Cancel
    keycode 232 = XF86MonBrightnessDown NoSymbol XF86MonBrightnessDown
    keycode 233 = XF86MonBrightnessUp NoSymbol XF86MonBrightnessUp
    keycode 234 = XF86AudioMedia NoSymbol XF86AudioMedia
    keycode 235 = XF86Display NoSymbol XF86Display
    keycode 236 = XF86KbdLightOnOff NoSymbol XF86KbdLightOnOff
    keycode 237 = XF86KbdBrightnessDown NoSymbol XF86KbdBrightnessDown
    keycode 238 = XF86KbdBrightnessUp NoSymbol XF86KbdBrightnessUp
    keycode 239 = XF86Send NoSymbol XF86Send
    keycode 240 = XF86Reply NoSymbol XF86Reply
    keycode 241 = XF86MailForward NoSymbol XF86MailForward
    keycode 242 = XF86Save NoSymbol XF86Save
    keycode 243 = XF86Documents NoSymbol XF86Documents
    keycode 244 = XF86Battery NoSymbol XF86Battery
    keycode 245 = XF86Bluetooth NoSymbol XF86Bluetooth
    keycode 246 = XF86WLAN NoSymbol XF86WLAN
    keycode 247 =
    keycode 248 =
    keycode 249 =
    keycode 250 =
    keycode 251 =
    keycode 252 =
    keycode 253 =
    keycode 254 = XF86WWAN NoSymbol XF86WWAN
    keycode 255 = XF86RFKill NoSymbol XF86RFKill
  #+END_SRC

* =.xinitrc=
  :PROPERTIES:
  :header-args: :tangle ~/.xinitrc
  :END:

  #+BEGIN_SRC sh
    exec dwm
    [[ -f ~/.Xmodmap ]] && xmodmap ~/.Xmodmap
  #+END_SRC
