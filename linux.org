#+TITLE: dotfiles for Linux
#+OPTIONS: toc:nil num:nil ^:nil
#+STARTUP: showall

In addition to the base =README.org= file, this document describes and
creates Linux specific configuration.

https://wiki.archlinux.org/index.php/Security#Lock_out_user_after_three_failed_login_attempts

* Fonts

  - https://askubuntu.com/questions/3697/how-do-i-install-fonts
  - Copied all to =/usr/local/share/fonts=
  - =fc-list=, =fc-cache=

* Display Manager

  GDM3 and Gnome 3 is stock on the Dell XPS 13 7390.  They are
  occasionally convenient but I don't want GDM to start by default.
  Console login is good.

  Disable GDM at boot, use console login

  - =sudo systemctl get-default=
  - =sudo systemctl set-default multi-user.target=

  For Gnome extensions, disable the stupid validate check that breaks
  stuff every time a new minor point release is published:

  =gsettings set org.gnome.shell "disable-extension-version-validation" true=

* Disable Canonical Tracking

  Bummer,
  https://www.howtogeek.com/349844/how-to-stop-ubuntu-from-collecting-data-about-your-pc/.

* Dell Stupid Super Key

  Boy, is this stupid:
  https://askubuntu.com/questions/751661/dell-developer-edition-ubuntu-14-04-super-key-not-working

* Console & Keyboard

  [[https://askubuntu.com/questions/485454/how-to-remap-keys-on-a-user-level-both-with-and-without-x][This didn't work]], I had to edit the =/etc/= files and I'm not sure
  why.

** =.console-setup=
   :PROPERTIES:
   :header-args: :tangle ~/.console-setup
   :END:

   This is currently empty but needs to exist for =.keyboard= to be
   read properly.

   =man 5 console-setup=

   #+BEGIN_SRC sh
   #+END_SRC

** =.keyboard=
   :PROPERTIES:
   :header-args: :tangle ~/.keyboard
   :END:

   =man 5 keyboard=

   #+BEGIN_SRC sh
     XKBOPTIONS="ctrl:swapcaps"
   #+END_SRC

** TODO =kmscon=

   https://www.freedesktop.org/wiki/Software/kmscon/

* CANCELED =xrandr=
  CLOSED: [2020-08-26 Wed 09:26]
  :LOGBOOK:
  - State "CANCELED"   from "TODO"       [2020-08-26 Wed 09:26] \\
    Sway manages monitors.  =xandr= should not be used with Sway.
  :END:

  https://gist.github.com/ryanpcmcquen/14adac20e6dd57a51b96

* =.config=

** =alacritty/alacritty.yml=
   :PROPERTIES:
   :header-args: :tangle ~/.config/alacritty/alacritty.yml
   :END:

   - Work on page up/down etc., with =showkey=
     https://github.com/alacritty/alacritty/issues/1593
   - https://github.com/arcticicestudio/nord-alacritty

   #+BEGIN_SRC yaml
     # Configuration for Alacritty, the GPU enhanced terminal emulator.

     # Any items in the `env` entry below will be added as
     # environment variables. Some entries may override variables
     # set by alacritty itself.
     #env:
       # TERM variable
       #
       # This value is used to set the `$TERM` environment variable for
       # each instance of Alacritty. If it is not present, alacritty will
       # check the local terminfo database and use `alacritty` if it is
       # available, otherwise `xterm-256color` is used.
       #TERM: alacritty

     #window:
       # Window dimensions (changes require restart)
       #
       # Specified in number of columns/lines, not pixels.
       # If both are `0`, this setting is ignored.
       #dimensions:
       #  columns: 0
       #  lines: 0

       # Window position (changes require restart)
       #
       # Specified in number of pixels.
       # If the position is not set, the window manager will handle the placement.
       #position:
       #  x: 0
       #  y: 0

       # Window padding (changes require restart)
       #
       # Blank space added around the window in pixels. This padding is scaled
       # by DPI and the specified value is always added at both opposing sides.
       #padding:
       #  x: 0
       #  y: 0

       # Spread additional padding evenly around the terminal content.
       #dynamic_padding: false

       # Window decorations
       #
       # Values for `decorations`:
       #     - full: Borders and title bar
       #     - none: Neither borders nor title bar
       #
       # Values for `decorations` (macOS only):
       #     - transparent: Title bar, transparent background and title bar buttons
       #     - buttonless: Title bar, transparent background, but no title bar buttons
       #decorations: full

       # Startup Mode (changes require restart)
       #
       # Values for `startup_mode`:
       #   - Windowed
       #   - Maximized
       #   - Fullscreen
       #
       # Values for `startup_mode` (macOS only):
       #   - SimpleFullscreen
       #startup_mode: Windowed

       # Window title
       #title: Alacritty

       # Window class (Linux/BSD only):
       #class:
         # Application instance name
         #instance: Alacritty
         # General application class
         #general: Alacritty

       # GTK theme variant (Linux/BSD only)
       #
       # Override the variant of the GTK theme. Commonly supported values are `dark` and `light`.
       # Set this to `None` to use the default theme variant.
       #gtk_theme_variant: None

     #scrolling:
       # Maximum number of lines in the scrollback buffer.
       # Specifying '0' will disable scrolling.
       #history: 10000

       # Number of lines the viewport will move for every line scrolled when
       # scrollback is enabled (history > 0).
       #multiplier: 3

     # Font configuration
     font:
       # Normal (roman) font face
       normal:
         # Font family
         #
         # Default:
         #   - (macOS) Menlo
         #   - (Linux/BSD) monospace
         #   - (Windows) Consolas
         family: PragmataPro Mono Liga

         # The `style` can be specified to pick a specific face.
         style: Regular

       # Bold font face
       #bold:
         # Font family
         #
         # If the bold family is not specified, it will fall back to the
         # value specified for the normal font.
         #family: monospace

         # The `style` can be specified to pick a specific face.
         #style: Bold

       # Italic font face
       #italic:
         # Font family
         #
         # If the italic family is not specified, it will fall back to the
         # value specified for the normal font.
         #family: monospace

         # The `style` can be specified to pick a specific face.
         #style: Italic

       # Bold italic font face
       #bold_italic:
         # Font family
         #
         # If the bold italic family is not specified, it will fall back to the
         # value specified for the normal font.
         #family: monospace

         # The `style` can be specified to pick a specific face.
         #style: Bold Italic

       # Point size
       size: 16.0

       # Offset is the extra space around each character. `offset.y` can be thought of
       # as modifying the line spacing, and `offset.x` as modifying the letter spacing.
       #offset:
       #  x: 0
       #  y: 0

       # Glyph offset determines the locations of the glyphs within their cells with
       # the default being at the bottom. Increasing `x` moves the glyph to the right,
       # increasing `y` moves the glyph upwards.
       #glyph_offset:
       #  x: 0
       #  y: 0

       # Thin stroke font rendering (macOS only)
       #
       # Thin strokes are suitable for retina displays, but for non-retina screens
       # it is recommended to set `use_thin_strokes` to `false`
       #
       # macOS >= 10.14.x:
       #
       # If the font quality on non-retina display looks bad then set
       # `use_thin_strokes` to `true` and enable font smoothing by running the
       # following command:
       #   `defaults write -g CGFontRenderingFontSmoothingDisabled -bool NO`
       #
       # This is a global setting and will require a log out or restart to take
       # effect.
       #use_thin_strokes: true

     # If `true`, bold text is drawn using the bright color variants.
     #draw_bold_text_with_bright_colors: false

     # Colors (Tomorrow Night Bright)
     #colors:
       # Default colors
       #primary:
       #  background: '#000000'
       #  foreground: '#eaeaea'

         # Bright and dim foreground colors
         #
         # The dimmed foreground color is calculated automatically if it is not present.
         # If the bright foreground color is not set, or `draw_bold_text_with_bright_colors`
         # is `false`, the normal foreground color will be used.
         #dim_foreground: '#9a9a9a'
         #bright_foreground: '#ffffff'

       # Cursor colors
       #
       # Colors which should be used to draw the terminal cursor. If these are unset,
       # the cursor color will be the inverse of the cell color.
       #cursor:
       #  text: '#000000'
       #  cursor: '#ffffff'

       # Selection colors
       #
       # Colors which should be used to draw the selection area. If selection
       # background is unset, selection color will be the inverse of the cell colors.
       # If only text is unset the cell text color will remain the same.
       #selection:
       #  text: '#eaeaea'
       #  background: '#404040'

       # Normal colors
       #normal:
       #  black:   '#000000'
       #  red:     '#d54e53'
       #  green:   '#b9ca4a'
       #  yellow:  '#e6c547'
       #  blue:    '#7aa6da'
       #  magenta: '#c397d8'
       #  cyan:    '#70c0ba'
       #  white:   '#eaeaea'

       # Bright colors
       #bright:
       #  black:   '#666666'
       #  red:     '#ff3334'
       #  green:   '#9ec400'
       #  yellow:  '#e7c547'
       #  blue:    '#7aa6da'
       #  magenta: '#b77ee0'
       #  cyan:    '#54ced6'
       #  white:   '#ffffff'

       # Dim colors
       #
       # If the dim colors are not set, they will be calculated automatically based
       # on the `normal` colors.
       #dim:
       #  black:   '#000000'
       #  red:     '#8c3336'
       #  green:   '#7a8530'
       #  yellow:  '#97822e'
       #  blue:    '#506d8f'
       #  magenta: '#80638e'
       #  cyan:    '#497e7a'
       #  white:   '#9a9a9a'

       # Indexed Colors
       #
       # The indexed colors include all colors from 16 to 256.
       # When these are not set, they're filled with sensible defaults.
       #
       # Example:
       #   `- { index: 16, color: '#ff00ff' }`
       #
       #indexed_colors: []

     # # Colors (Tomorrow Night Bright)
     # colors:
     #   # Default colors
     #   primary:
     #     background: '0x000000'
     #     foreground: '0xeaeaea'

     #   # Normal colors
     #   normal:
     #     black:   '0x000000'
     #     red:     '0xd54e53'
     #     green:   '0xb9ca4a'
     #     yellow:  '0xe6c547'
     #     blue:    '0x7aa6da'
     #     magenta: '0xc397d8'
     #     cyan:    '0x70c0ba'
     #     white:   '0x424242'

     #   # Bright colors
     #   bright:
     #     black:   '0x666666'
     #     red:     '0xff3334'
     #     green:   '0x9ec400'
     #     yellow:  '0xe7c547'
     #     blue:    '0x7aa6da'
     #     magenta: '0xb77ee0'
     #     cyan:    '0x54ced6'
     #     white:   '0x2a2a2a'

     # # Colors (Tomorrow Day)
     # colors:
     #   # Default colors
     #   primary:
     #     background: '0xffffff'
     #     foreground: '0x4d4d4c'

     #   # Normal colors
     #   normal:
     #     black:   '0x000000'
     #     red:     '0xc82829'
     #     green:   '0x718c00'
     #     yellow:  '0xeab700'
     #     blue:    '0x4271ae'
     #     magenta: '0x8959a8'
     #     cyan:    '0x3e999f'
     #     white:   '0xefefef'

     #   # Bright colors
     #   bright:
     #     black:   '0x000000'
     #     red:     '0xc82829'
     #     green:   '0x9ec400'
     #     yellow:  '0xeab700'
     #     blue:    '0x4271ae'
     #     magenta: '0x8959a8'
     #     cyan:    '0x3e999f'
     #     white:   '0xefefef'



     # Copyright (c) 2017-present Arctic Ice Studio <development@arcticicestudio.com>
     # Copyright (c) 2017-present Sven Greb <code@svengreb.de>

     # Project:    Nord Alacritty
     # Version:    0.1.0
     # Repository: https://github.com/arcticicestudio/nord-alacritty
     # License:    MIT
     # References:
     #   https://github.com/alacritty/alacritty

     colors:
       primary:
         background: '#2e3440'
         foreground: '#d8dee9'
         dim_foreground: '#a5abb6'
       cursor:
         text: '#2e3440'
         cursor: '#d8dee9'
       vi_mode_cursor:
         text: '#2e3440'
         cursor: '#d8dee9'
       selection:
         text: CellForeground
         background: '#4c566a'
       search:
         matches:
           foreground: CellBackground
           background: '#88c0d0'
         bar:
           background: '#434c5e'
           foreground: '#d8dee9'
       normal:
         black: '#3b4252'
         red: '#bf616a'
         green: '#a3be8c'
         yellow: '#ebcb8b'
         blue: '#81a1c1'
         magenta: '#b48ead'
         cyan: '#88c0d0'
         white: '#e5e9f0'
       bright:
         black: '#4c566a'
         red: '#bf616a'
         green: '#a3be8c'
         yellow: '#ebcb8b'
         blue: '#81a1c1'
         magenta: '#b48ead'
         cyan: '#8fbcbb'
         white: '#eceff4'
       dim:
         black: '#373e4d'
         red: '#94545d'
         green: '#809575'
         yellow: '#b29e75'
         blue: '#68809a'
         magenta: '#8c738c'
         cyan: '#6d96a5'
         white: '#aeb3bb'



     # Visual Bell
     #
     # Any time the BEL code is received, Alacritty "rings" the visual bell. Once
     # rung, the terminal background will be set to white and transition back to the
     # default background color. You can control the rate of this transition by
     # setting the `duration` property (represented in milliseconds). You can also
     # configure the transition function by setting the `animation` property.
     #
     # Values for `animation`:
     #   - Ease
     #   - EaseOut
     #   - EaseOutSine
     #   - EaseOutQuad
     #   - EaseOutCubic
     #   - EaseOutQuart
     #   - EaseOutQuint
     #   - EaseOutExpo
     #   - EaseOutCirc
     #   - Linear
     #
     # Specifying a `duration` of `0` will disable the visual bell.
     #visual_bell:
     #  animation: EaseOutExpo
     #  duration: 0
     #  color: '#ffffff'

     # Background opacity
     #
     # Window opacity as a floating point number from `0.0` to `1.0`.
     # The value `0.0` is completely transparent and `1.0` is opaque.
     background_opacity: 0.95

     #selection:
       #semantic_escape_chars: ",│`|:\"' ()[]{}<>\t"

       # When set to `true`, selected text will be copied to the primary clipboard.
       #save_to_clipboard: false

     # Allow terminal applications to change Alacritty's window title.
     #dynamic_title: true

     cursor:
       # Cursor style
       style:
         # Cursor shape
         #
         # Values for `shape`:
         #   - ▇ Block
         #   - _ Underline
         #   - | Beam
         shape: Block

         # Cursor blinking state
         #
         # Values for `blinking`:
         #   - Never: Prevent the cursor from ever blinking
         #   - Off: Disable blinking by default
         #   - On: Enable blinking by default
         #   - Always: Force the cursor to always blink
         blinking: On

       # If this is `true`, the cursor will be rendered as a hollow box when the
       # window is not focused.
       unfocused_hollow: true

       # Vi mode cursor style
       #
       # If the vi mode cursor style is `None` or not specified, it will fall back to
       # the style of the active value of the normal cursor.
       #
       # See `cursor.style` for available options.
       #vi_mode_style: None

       # Cursor blinking interval in milliseconds.
       #blink_interval: 750

     # Live config reload (changes require restart)
     #live_config_reload: true

     # Shell
     #
     # You can set `shell.program` to the path of your favorite shell, e.g. `/bin/fish`.
     # Entries in `shell.args` are passed unmodified as arguments to the shell.
     #
     # Default:
     #   - (macOS) /bin/bash --login
     #   - (Linux/BSD) user login shell
     #   - (Windows) powershell
     #shell:
     #  program: /bin/bash
     #  args:
     #    - --login

     # Startup directory
     #
     # Directory the shell is started in. If this is unset, or `None`, the working
     # directory of the parent process will be used.
     #working_directory: None

     # WinPTY backend (Windows only)
     #
     # Alacritty defaults to using the newer ConPTY backend if it is available,
     # since it resolves a lot of bugs and is quite a bit faster. If it is not
     # available, the the WinPTY backend will be used instead.
     #
     # Setting this option to `true` makes Alacritty use the legacy WinPTY backend,
     # even if the ConPTY backend is available.
     #winpty_backend: false

     # Send ESC (\x1b) before characters when alt is pressed.
     #alt_send_esc: true

     #mouse:
       # Click settings
       #
       # The `double_click` and `triple_click` settings control the time
       # alacritty should wait for accepting multiple clicks as one double
       # or triple click.
       #double_click: { threshold: 300 }
       #triple_click: { threshold: 300 }

       # If this is `true`, the cursor is temporarily hidden when typing.
       #hide_when_typing: false

       #url:
         # URL launcher
         #
         # This program is executed when clicking on a text which is recognized as a URL.
         # The URL is always added to the command as the last parameter.
         #
         # When set to `None`, URL launching will be disabled completely.
         #
         # Default:
         #   - (macOS) open
         #   - (Linux/BSD) xdg-open
         #   - (Windows) explorer
         #launcher:
         #  program: xdg-open
         #  args: []

         # URL modifiers
         #
         # These are the modifiers that need to be held down for opening URLs when clicking
         # on them. The available modifiers are documented in the key binding section.
         #modifiers: None

     # Mouse bindings
     #
     # Mouse bindings are specified as a list of objects, much like the key
     # bindings further below.
     #
     # To trigger mouse bindings when an application running within Alacritty captures the mouse, the
     # `Shift` modifier is automatically added as a requirement.
     #
     # Each mouse binding will specify a:
     #
     # - `mouse`:
     #
     #   - Middle
     #   - Left
     #   - Right
     #   - Numeric identifier such as `5`
     #
     # - `action` (see key bindings)
     #
     # And optionally:
     #
     # - `mods` (see key bindings)
     #mouse_bindings:
     #  - { mouse: Middle, action: PasteSelection }

     # Key bindings
     #
     # Key bindings are specified as a list of objects. For example, this is the
     # default paste binding:
     #
     # `- { key: V, mods: Control|Shift, action: Paste }`
     #
     # Each key binding will specify a:
     #
     # - `key`: Identifier of the key pressed
     #
     #    - A-Z
     #    - F1-F24
     #    - Key0-Key9
     #
     #    A full list with available key codes can be found here:
     #    https://docs.rs/glutin/*/glutin/event/enum.VirtualKeyCode.html#variants
     #
     #    Instead of using the name of the keys, the `key` field also supports using
     #    the scancode of the desired key. Scancodes have to be specified as a
     #    decimal number. This command will allow you to display the hex scancodes
     #    for certain keys:
     #
     #       `showkey --scancodes`.
     #
     # Then exactly one of:
     #
     # - `chars`: Send a byte sequence to the running application
     #
     #    The `chars` field writes the specified string to the terminal. This makes
     #    it possible to pass escape sequences. To find escape codes for bindings
     #    like `PageUp` (`"\x1b[5~"`), you can run the command `showkey -a` outside
     #    of tmux. Note that applications use terminfo to map escape sequences back
     #    to keys. It is therefore required to update the terminfo when changing an
     #    escape sequence.
     #
     # - `action`: Execute a predefined action
     #
     #   - Copy
     #   - Paste
     #   - PasteSelection
     #   - IncreaseFontSize
     #   - DecreaseFontSize
     #   - ResetFontSize
     #   - ScrollPageUp
     #   - ScrollPageDown
     #   - ScrollLineUp
     #   - ScrollLineDown
     #   - ScrollToTop
     #   - ScrollToBottom
     #   - ClearHistory
     #   - Hide
     #   - Minimize
     #   - Quit
     #   - ToggleFullscreen
     #   - SpawnNewInstance
     #   - ClearLogNotice
     #   - ReceiveChar
     #   - None
     #
     #   (macOS only):
     #   - ToggleSimpleFullscreen: Enters fullscreen without occupying another space
     #
     # - `command`: Fork and execute a specified command plus arguments
     #
     #    The `command` field must be a map containing a `program` string and an
     #    `args` array of command line parameter strings. For example:
     #       `{ program: "alacritty", args: ["-e", "vttest"] }`
     #
     # And optionally:
     #
     # - `mods`: Key modifiers to filter binding actions
     #
     #    - Command
     #    - Control
     #    - Option
     #    - Super
     #    - Shift
     #    - Alt
     #
     #    Multiple `mods` can be combined using `|` like this:
     #       `mods: Control|Shift`.
     #    Whitespace and capitalization are relevant and must match the example.
     #
     # - `mode`: Indicate a binding for only specific terminal reported modes
     #
     #    This is mainly used to send applications the correct escape sequences
     #    when in different modes.
     #
     #    - AppCursor
     #    - AppKeypad
     #    - Alt
     #
     #    A `~` operator can be used before a mode to apply the binding whenever
     #    the mode is *not* active, e.g. `~Alt`.
     #
     # Bindings are always filled by default, but will be replaced when a new
     # binding with the same triggers is defined. To unset a default binding, it can
     # be mapped to the `ReceiveChar` action. Alternatively, you can use `None` for
     # a no-op if you do not wish to receive input characters for that binding.
     #
     # If the same trigger is assigned to multiple actions, all of them are executed
     # at once.
     #key_bindings:
       # (Windows, Linux, and BSD only)
       #- { key: V,        mods: Control|Shift, action: Paste            }
       #- { key: C,        mods: Control|Shift, action: Copy             }
       #- { key: Insert,   mods: Shift,         action: PasteSelection   }
       #- { key: Key0,     mods: Control,       action: ResetFontSize    }
       #- { key: Equals,   mods: Control,       action: IncreaseFontSize }
       #- { key: Add,      mods: Control,       action: IncreaseFontSize }
       #- { key: Subtract, mods: Control,       action: DecreaseFontSize }
       #- { key: Minus,    mods: Control,       action: DecreaseFontSize }

       # (Windows only)
       #- { key: Return,   mods: Alt,           action: ToggleFullscreen }

       # (macOS only)
       #- { key: Key0,   mods: Command,         action: ResetFontSize    }
       #- { key: Equals, mods: Command,         action: IncreaseFontSize }
       #- { key: Add,    mods: Command,         action: IncreaseFontSize }
       #- { key: Minus,  mods: Command,         action: DecreaseFontSize }
       #- { key: K,      mods: Command,         action: ClearHistory     }
       #- { key: K,      mods: Command,         chars: "\x0c"            }
       #- { key: V,      mods: Command,         action: Paste            }
       #- { key: C,      mods: Command,         action: Copy             }
       #- { key: H,      mods: Command,         action: Hide             }
       #- { key: M,      mods: Command,         action: Minimize         }
       #- { key: Q,      mods: Command,         action: Quit             }
       #- { key: W,      mods: Command,         action: Quit             }
       #- { key: F,      mods: Command|Control, action: ToggleFullscreen }

       #- { key: Paste,                    action: Paste                            }
       #- { key: Copy,                     action: Copy                             }
       #- { key: L,         mods: Control, action: ClearLogNotice                   }
       #- { key: L,         mods: Control, chars: "\x0c"                            }
       #- { key: PageUp,    mods: Shift,   action: ScrollPageUp,   mode: ~Alt       }
       #- { key: PageDown,  mods: Shift,   action: ScrollPageDown, mode: ~Alt       }
       #- { key: Home,      mods: Shift,   action: ScrollToTop,    mode: ~Alt       }
       #- { key: End,       mods: Shift,   action: ScrollToBottom, mode: ~Alt       }

     #debug:
       # Display the time it takes to redraw each frame.
       #render_timer: false

       # Keep the log file after quitting Alacritty.
       #persistent_logging: false

       # Log level
       #
       # Values for `log_level`:
       #   - None
       #   - Error
       #   - Warn
       #   - Info
       #   - Debug
       #   - Trace
       #log_level: Warn

       # Print all received window events.
       #print_events: false
   #+END_SRC

** =gammastep/config.ini=
   :PROPERTIES:
   :header-args: :tangle ~/.config/gammastep/config.ini
   :END:

   This is a fork of Redshift that works with Wayland.

   =mkdir -p "${HOME}/.config/gammastep=

   #+BEGIN_SRC conf
     ; Global settings
     [general]
     ; Set the day and night screen temperatures
     temp-day=5700
     temp-night=3500

     ; Disable the smooth fade between temperatures when Redshift starts and stops.
     ; 0 will cause an immediate change between screen temperatures.
     ; 1 will gradually apply the new screen temperature over a couple of seconds.
     fade=1

     ; Solar elevation thresholds.
     ; By default, Redshift will use the current elevation of the sun to determine
     ; whether it is daytime, night or in transition (dawn/dusk). When the sun is
     ; above the degrees specified with elevation-high it is considered daytime and
     ; below elevation-low it is considered night.
     ;elevation-high=3
     ;elevation-low=-6

     ; Custom dawn/dusk intervals.
     ; Instead of using the solar elevation, the time intervals of dawn and dusk
     ; can be specified manually. The times must be specified as HH:MM in 24-hour
     ; format.
     ;dawn-time=6:00-7:45
     ;dusk-time=18:35-20:15

     ; Set the screen brightness. Default is 1.0.
     ;brightness=0.9
     ; It is also possible to use different settings for day and night
     ; since version 1.8.
     ;brightness-day=0.7
     ;brightness-night=0.4
     ; Set the screen gamma (for all colors, or each color channel
     ; individually)
     gamma=0.8
     ;gamma=0.8:0.7:0.8
     ; This can also be set individually for day and night since
     ; version 1.10.
     ;gamma-day=0.8:0.7:0.8
     ;gamma-night=0.6

     ; Set the location-provider: 'geoclue2', 'manual'.
     ; The location provider settings are in a different section.
     location-provider=manual

     ; Set the adjustment-method: 'randr', 'vidmode', 'drm', 'wayland'.
     ; 'randr' is the preferred X11 method, 'vidmode' is an older API
     ; that works in some cases when 'randr' does not.
     ; The adjustment method settings are in a different section.
     adjustment-method=wayland

     ; Configuration of the location-provider:
     ; type 'gammastep -l PROVIDER:help' to see the settings.
     ; ex: 'gammastep -l manual:help'
     ; Keep in mind that longitudes west of Greenwich (e.g. the Americas)
     ; are negative numbers.
     [manual]
     lat=40.0
     lon=-75.7

     ; Configuration of the adjustment-method
     ; type 'gammastep -m METHOD:help' to see the settings.
     ; ex: 'gammastep -m randr:help'
     ; In this example, randr is configured to adjust only screen 0.
     ; Note that the numbering starts from 0, so this is actually the first screen.
     ; If this option is not specified, Redshift will try to adjust _all_ screens.
     ; [randr]
     ; screen=0
   #+END_SRC

** =sway/sway.cfg=
   :PROPERTIES:
   :header-args: :tangle ~/.config/sway/config
   :END:

   #+BEGIN_SRC conf
     # Read `man 5 sway` for a complete reference.

     ### Variables
     #
     # Logo key. Use Mod1 for Alt.
     set $mod Mod4
     # Your preferred terminal emulator
     set $term alacritty
     # Your preferred application launcher
     # Note: pass the final command to swaymsg so that the resulting window can be opened
     # on the original workspace that the command was run on.
     #set $menu dmenu_path | dmenu | xargs swaymsg exec --
     set $menu dmenu_path | wofi --show drun -i | xargs swaymsg exec --

     exec mako
     bindsym $mod+Escape exec makoctl dismiss -a

     ### Output configuration
     #
     # Default wallpaper (more resolutions are available in /usr/share/backgrounds/sway/)
     output * background /home/kris/img/linen.jpg fill
     #
     # Example configuration:
     #
     #   output HDMI-A-1 resolution 1920x1080 position 1920,0
     #
     # You can get the names of your outputs by running: swaymsg -t get_outputs

     output eDP-1 mode 1920x1080 position 0,0
     output 'Dell Inc. DELL U3818DW 97F8P77D0E3L' mode 3840x1600 position 1920,0

     ### Idle configuration
     #
     # Example configuration:
     #
     # exec swayidle -w \
     #          timeout 300 'swaylock -f -c 000000' \
     #          timeout 600 'swaymsg "output * dpms off"' \
     #               resume 'swaymsg "output * dpms on"' \
     #          before-sleep 'swaylock -f -c 000000'
     #
     # This will lock your screen after 300 seconds of inactivity, then turn off
     # your displays after another 300 seconds, and turn your screens back on when
     # resumed. It will also lock your screen before your computer goes to sleep.

     exec swayidle -w \
              timeout 300 'swaymsg "output * dpms off"' \
                   resume 'swaymsg "output * dpms on"'

     ### Input configuration
     #
     # Example configuration:
     #
     #   input "2:14:SynPS/2_Synaptics_TouchPad" {
     #       dwt enabled
     #       tap enabled
     #       natural_scroll enabled
     #       middle_emulation enabled
     #   }
     #
     # You can get the names of your inputs by running: swaymsg -t get_inputs
     # Read `man 5 sway-input` for more information about this section.

     input type:keyboard {
         xkb_layout us
         xkb_variant dvorak
         xkb_options ctrl:nocaps
     }

     input type:touchpad {
         natural_scroll enabled
     }

     input type:mouse {
     }

     ### Key bindings
     #
     # Basics:
     #
         # Start a terminal
         bindsym $mod+Return exec $term

         # Kill focused window
         bindsym $mod+Shift+q kill

         # Start your launcher
         bindsym $mod+d exec $menu

         # Drag floating windows by holding down $mod and left mouse button.
         # Resize them with right mouse button + $mod.
         # Despite the name, also works for non-floating windows.
         # Change normal to inverse to use left mouse button for resizing and right
         # mouse button for dragging.
         floating_modifier $mod normal

         # Reload the configuration file
         bindsym $mod+Shift+c reload

         # Exit sway (logs you out of your Wayland session)
         bindsym $mod+Shift+e exec swaynag -t warning -m 'You pressed the exit shortcut. Do you really want to exit sway? This will end your Wayland session.' -b 'Yes, exit sway' 'swaymsg exit'
     #
     # Moving around:
     #
         # Move your focus around
         bindsym $mod+Shift+space focus left
         bindsym $mod+space focus right
         bindsym $mod+Left focus left
         bindsym $mod+Down focus down
         bindsym $mod+Up focus up
         bindsym $mod+Right focus right

         # Move the focused window with the same, but add Shift
         bindsym $mod+Shift+Left move left
         bindsym $mod+Shift+Down move down
         bindsym $mod+Shift+Up move up
         bindsym $mod+Shift+Right move right
     #
     # Workspaces:
     #
         # Switch to workspace
         bindsym $mod+1 workspace 1
         bindsym $mod+2 workspace 2
         bindsym $mod+3 workspace 3
         bindsym $mod+4 workspace 4
         bindsym $mod+5 workspace 5
         bindsym $mod+6 workspace 6
         bindsym $mod+7 workspace 7
         bindsym $mod+8 workspace 8
         bindsym $mod+9 workspace 9
         bindsym $mod+0 workspace 10
         # Move focused container to workspace
         bindsym $mod+Shift+1 move container to workspace 1
         bindsym $mod+Shift+2 move container to workspace 2
         bindsym $mod+Shift+3 move container to workspace 3
         bindsym $mod+Shift+4 move container to workspace 4
         bindsym $mod+Shift+5 move container to workspace 5
         bindsym $mod+Shift+6 move container to workspace 6
         bindsym $mod+Shift+7 move container to workspace 7
         bindsym $mod+Shift+8 move container to workspace 8
         bindsym $mod+Shift+9 move container to workspace 9
         bindsym $mod+Shift+0 move container to workspace 10
         # Note: workspaces can have any name you want, not just numbers.
         # We just use 1-10 as the default.
         bindsym $mod+tab workspace back_and_forth
     #
     # Layout stuff:
     #
         # You can "split" the current object of your focus with
         # $mod+b or $mod+v, for horizontal and vertical splits
         # respectively.
         bindsym $mod+b splith
         bindsym $mod+v splitv

         # Switch the current container between different layout styles
         bindsym $mod+s layout stacking
         bindsym $mod+w layout tabbed
         bindsym $mod+e layout toggle split

         # Make the current focus fullscreen
         bindsym $mod+f fullscreen

         # Toggle the current focus between tiling and floating mode
         bindsym $mod+Shift+f floating toggle

         # Swap focus between the tiling area and the floating area
         # bindsym $mod+space focus mode_toggle

         # Move focus to the parent container
         bindsym $mod+a focus parent
     #
     # Scratchpad:
     #
         # Sway has a "scratchpad", which is a bag of holding for windows.
         # You can send windows there and get them back later.

         # Move the currently focused window to the scratchpad
         bindsym $mod+Shift+minus move scratchpad

         # Show the next scratchpad window or hide the focused scratchpad window.
         # If there are multiple scratchpad windows, this command cycles through them.
         bindsym $mod+minus scratchpad show
     #
     # Resizing containers:
     #
     mode "resize" {
         # left will shrink the containers width
         # right will grow the containers width
         # up will shrink the containers height
         # down will grow the containers height
         bindsym Left resize shrink width 10px
         bindsym Down resize grow height 10px
         bindsym Up resize shrink height 10px
         bindsym Right resize grow width 10px

         # Return to default mode
         bindsym Return mode "default"
         bindsym Escape mode "default"
     }
     bindsym $mod+r mode "resize"

     # From https://wiki.archlinux.org/index.php/Sway#Custom_keybindings
     bindsym XF86AudioRaiseVolume exec pactl set-sink-volume @DEFAULT_SINK@ +5%
     bindsym XF86AudioLowerVolume exec pactl set-sink-volume @DEFAULT_SINK@ -5%
     bindsym XF86AudioMute exec pactl set-sink-mute @DEFAULT_SINK@ toggle
     bindsym XF86MonBrightnessDown exec brightnessctl set 5%-
     bindsym XF86MonBrightnessUp exec brightnessctl set +5%

     font PragmataPro Mono Liga 14

     #
     # Status Bar:
     #
     # Read `man 5 sway-bar` for more information about this section.
     # Read https://github.com/Alexays/Waybar/wiki/Configuration for waybar
     bar {
         swaybar_command waybar
     }

     include /etc/sway/config.d/*
   #+END_SRC

** [[https://github.com/Alexays/Waybar][=waybar=]]

   An alternative to the built-in =swaybar=.  This is configured over
   the built-in above in the Sway config =bar= block.

*** =config=
   :PROPERTIES:
   :header-args: :tangle ~/.config/waybar/config
   :END:

   #+BEGIN_SRC js
     {
         // "layer": "top", // Waybar at top layer
         // "position": "bottom", // Waybar position (top|bottom|left|right)
         "height": 30, // Waybar height (to be removed for auto height)
         // "width": 1280, // Waybar width
         // Choose the order of the modules
         "modules-left": ["sway/workspaces", "sway/mode", "custom/media"],
         "modules-center": ["sway/window"],
         "modules-right": [
             "idle_inhibitor",
             "cpu",
             "memory",
             "disk",
             "temperature",
             "pulseaudio",
             "backlight",
             "network",
             "battery",
             "clock",
             "tray"
         ],
         // Modules configuration
         // "sway/workspaces": {
         //     "disable-scroll": true,
         //     "all-outputs": true,
         //     "format": "{name}: {icon}",
         //     "format-icons": {
         //         "1": "",
         //         "2": "",
         //         "3": "",
         //         "4": "",
         //         "5": "",
         //         "urgent": "",
         //         "focused": "",
         //         "default": ""
         //     }
         // },
         "sway/mode": {
             "format": "<span style=\"italic\">{}</span>"
         },
         "idle_inhibitor": {
             "format": "{icon}",
             "format-icons": {
                 "activated": "",
                 "deactivated": ""
             }
         },
         "tray": {
             // "icon-size": 21,
             "spacing": 10
         },
         "clock": {
             // "timezone": "America/New_York",
             "tooltip-format": "<big>{:%Y %B}</big>\n<tt><small>{calendar}</small></tt>",
             "format": "{:%a, %b %d %H%M}"
         },
         "disk": {
             "interval": 30,
             "format": "{path} {percentage_used}%",
             "path": "/"
         },
         "cpu": {
             "format": "CPU {usage}%",
             "tooltip": true
         },
         "memory": {
             "format": "MEM {}%"
         },
         "temperature": {
             // "hwmon-path": "/sys/class/hwmon/hwmon2/temp1_input",
             "thermal-zone": 8,
             "critical-threshold": 80,
             "format": "{temperatureC}°C",
             "format-critical": "{temperatureC}°C 🔥"
         },
         "backlight": {
             // "device": "acpi_video1",
             "format": "{percent}% {icon}",
             "format-icons": ["", ""]
         },
         "battery": {
             "states": {
                 // "good": 95,
                 "warning": 30,
                 "critical": 15
             },
             "format": "{capacity}% {icon}",
             "format-charging": "{capacity}% ",
             "format-plugged": "{capacity}% ",
             "format-alt": "{time} {icon}",
             // "format-good": "", // An empty format will hide the module
             // "format-full": "",
             "format-icons": ["", "", "", "", ""]
         },
         "network": {
             // "interface": "wlp2*", // (Optional) To force the use of this interface
             "format-wifi": "{essid} ",
             "format-ethernet": "{ifname}: {ipaddr}/{cidr} ",
             "format-linked": "{ifname} (No IP) ",
             "format-disconnected": "Disconnected ⚠",
             "format-alt": "{ifname}: {ipaddr}/{cidr}"
         },
         "pulseaudio": {
             // "scroll-step": 1, // %, can be a float
             "format": "{volume}% {icon} {format_source}",
             "format-bluetooth": "{volume}% {icon} {format_source}",
             "format-bluetooth-muted": " {icon} {format_source}",
             "format-muted": " {format_source}",
             "format-source": "{volume}% ",
             "format-source-muted": "",
             "format-icons": {
                 "headphone": "",
                 "hands-free": "",
                 "headset": "",
                 "phone": "",
                 "portable": "",
                 "car": "",
                 "default": ["", "", ""]
             },
             "on-click": "pavucontrol"
         },
         "custom/media": {
             "format": "{icon} {}",
             "return-type": "json",
             "max-length": 40,
             "format-icons": {
                 "spotify": "",
                 "default": "🎜"
             },
             "escape": true,
             "exec": "$HOME/.config/waybar/mediaplayer.py 2> /dev/null" // Script in resources folder
             // "exec": "$HOME/.config/waybar/mediaplayer.py --player spotify 2> /dev/null" // Filter player based on name
         }
     }
   #+END_SRC

*** =style.css=
   :PROPERTIES:
   :header-args: :tangle ~/.config/waybar/style.css
   :END:

    #+BEGIN_SRC css
      ,* {
          border: none;
          border-radius: 0;
          /* `otf-font-awesome` is required to be installed for icons */
          font-family: PragmataPro Liga, Helvetica, Arial, sans-serif;
          font-size: 16px;
          min-height: 0;
      }

      window#waybar {
          background-color: rgba(43, 48, 59, 0.5);
          border-bottom: 3px solid rgba(100, 114, 125, 0.5);
          color: #ffffff;
          transition-property: background-color;
          transition-duration: .5s;
      }

      window#waybar.hidden {
          opacity: 0.2;
      }

      /*
      window#waybar.empty {
          background-color: transparent;
      }
      window#waybar.solo {
          background-color: #FFFFFF;
      }
      ,*/

      window#waybar.termite {
          background-color: #3F3F3F;
      }

      window#waybar.chromium {
          background-color: #000000;
          border: none;
      }

      #workspaces button {
          padding: 0 5px;
          background-color: transparent;
          color: #ffffff;
          border-bottom: 3px solid transparent;
      }

      /* https://github.com/Alexays/Waybar/wiki/FAQ#the-workspace-buttons-have-a-strange-hover-effect */
      #workspaces button:hover {
          background: rgba(0, 0, 0, 0.2);
          box-shadow: inherit;
          border-bottom: 3px solid #ffffff;
      }

      #workspaces button.focused {
          background-color: #64727D;
          border-bottom: 3px solid #ffffff;
      }

      #workspaces button.urgent {
          background-color: #eb4d4b;
      }

      #mode {
          background-color: #64727D;
          border-bottom: 3px solid #ffffff;
      }

      #clock,
      #battery,
      #cpu,
      #disk,
      #memory,
      #temperature,
      #backlight,
      #network,
      #pulseaudio,
      #custom-media,
      #tray,
      #mode,
      #idle_inhibitor,
      #mpd {
          padding: 0 10px;
          margin: 0 4px;
          color: #ffffff;
      }

      #clock {
          background-color: #64727D;
      }

      #battery {
          background-color: #ffffff;
          color: #000000;
      }

      #battery.charging {
          color: #ffffff;
          background-color: #26A65B;
      }

      @keyframes blink {
          to {
              background-color: #ffffff;
              color: #000000;
          }
      }

      #battery.critical:not(.charging) {
          background-color: #f53c3c;
          color: #ffffff;
          animation-name: blink;
          animation-duration: 0.5s;
          animation-timing-function: linear;
          animation-iteration-count: infinite;
          animation-direction: alternate;
      }

      label:focus {
          background-color: #000000;
      }

      #cpu {
          background-color: #2ecc71;
          color: #000000;
      }

      #memory {
          background-color: #9b59b6;
      }

      #backlight {
          background-color: #90b1b1;
      }

      #network {
          background-color: #2980b9;
      }

      #network.disconnected {
          background-color: #f53c3c;
      }

      #pulseaudio {
          background-color: #f1c40f;
          color: #000000;
      }

      #pulseaudio.muted {
          background-color: #90b1b1;
          color: #2a5c45;
      }

      #custom-media {
          background-color: #66cc99;
          color: #2a5c45;
          min-width: 100px;
      }

      #custom-media.custom-spotify {
          background-color: #66cc99;
      }

      #custom-media.custom-vlc {
          background-color: #ffa000;
      }

      #temperature {
          background-color: #f0932b;
      }

      #temperature.critical {
          background-color: #eb4d4b;
      }

      #tray {
          background-color: #2980b9;
      }

      #idle_inhibitor {
          background-color: #2d3436;
      }

      #idle_inhibitor.activated {
          background-color: #ecf0f1;
          color: #2d3436;
      }

      #mpd {
          background-color: #66cc99;
          color: #2a5c45;
      }

      #mpd.disconnected {
          background-color: #f53c3c;
      }

      #mpd.stopped {
          background-color: #90b1b1;
      }

      #mpd.paused {
          background-color: #51a37a;
      }
    #+END_SRC

** =[[https://wayland.emersion.fr/mako/][mako]]=

*** =config=
   :PROPERTIES:
   :header-args: :tangle ~/.config/mako/config
   :END:

   #+BEGIN_SRC conf
   #+END_SRC

** =sway/swaybar.sh=
   :PROPERTIES:
   :header-args: :tangle ~/.config/sway/swaybar.sh
   :END:

   TODO make sure that the tangled file has executable bit set!

   #+BEGIN_SRC sh
     #!/usr/bin/env bash

     battery="🔋$(cat /sys/class/power_supply/BAT0/capacity)%"

     brightness="🌖 $(brightnessctl info -m | cut -d, -f 4)"

     # wifi="📶 $(nmcli --get-values GENERAL.CONNECTION device show wlan0)"
     # shellcheck disable=SC2063
     wifi="📶 $(nmcli --fields IN-USE,SSID,BARS device wifi list | grep '^*' | tr -s ' ' | cut -d ' ' -f 2-)"

     date="⏰ $(date +'%a, %b %d %H%M')"

     volume="🎶 $(pulsemixer --get-volume --id sink-0 | cut -d ' ' -f 1)%"

     uptime="↑ $(uptime | cut -d , -f 1 | cut -d ' ' -f 4,5)"

     echo "${volume}  ${brightness}  ${wifi}  ${battery}  ${uptime}  ${date}"
   #+END_SRC

* =.dircolors=
  :PROPERTIES:
  :header-args: :tangle ~/.dir_colors
  :END:

  #+BEGIN_SRC sh
    # Copyright (C) 2017-present Arctic Ice Studio <development@arcticicestudio.com>
    # Copyright (C) 2017-present Sven Greb <development@svengreb.de>

    # Project:    Nord dircolors
    # Version:    0.2.0
    # Repository: https://github.com/arcticicestudio/nord-dircolors
    # License:    MIT

    COLOR tty

    TERM alacritty
    TERM alacritty-direct
    TERM ansi
    TERM *color*
    TERM con[0-9]*x[0-9]*
    TERM cons25
    TERM console
    TERM cygwin
    TERM dtterm
    TERM dvtm
    TERM dvtm-256color
    TERM Eterm
    TERM eterm-color
    TERM fbterm
    TERM gnome
    TERM gnome-256color
    TERM hurd
    TERM jfbterm
    TERM konsole
    TERM konsole-256color
    TERM kterm
    TERM linux
    TERM linux-c
    TERM mlterm
    TERM putty
    TERM putty-256color
    TERM rxvt*
    TERM rxvt-unicode
    TERM rxvt-256color
    TERM rxvt-unicode256
    TERM screen*
    TERM screen-256color
    TERM st
    TERM st-256color
    TERM terminator
    TERM tmux*
    TERM tmux-256color
    TERM vt100
    TERM xterm*
    TERM xterm-color
    TERM xterm-88color
    TERM xterm-256color
    TERM xterm-kitty

    ,#+-----------------+
    ,#+ Global Defaults +
    ,#+-----------------+
    NORMAL 00
    RESET 0

    FILE 00
    DIR 01;34
    LINK 36
    MULTIHARDLINK 04;36

    FIFO 04;01;36
    SOCK 04;33
    DOOR 04;01;36
    BLK 01;33
    CHR 33

    ORPHAN 31
    MISSING 01;37;41

    EXEC 01;36

    SETUID 01;04;37
    SETGID 01;04;37
    CAPABILITY 01;37

    STICKY_OTHER_WRITABLE 01;37;44
    OTHER_WRITABLE 01;04;34
    STICKY 04;37;44

    ,#+-------------------+
    ,#+ Extension Pattern +
    ,#+-------------------+
    ,#+--- Archives ---+
    .7z 01;32
    .ace 01;32
    .alz 01;32
    .arc 01;32
    .arj 01;32
    .bz 01;32
    .bz2 01;32
    .cab 01;32
    .cpio 01;32
    .deb 01;32
    .dz 01;32
    .ear 01;32
    .gz 01;32
    .jar 01;32
    .lha 01;32
    .lrz 01;32
    .lz 01;32
    .lz4 01;32
    .lzh 01;32
    .lzma 01;32
    .lzo 01;32
    .rar 01;32
    .rpm 01;32
    .rz 01;32
    .sar 01;32
    .t7z 01;32
    .tar 01;32
    .taz 01;32
    .tbz 01;32
    .tbz2 01;32
    .tgz 01;32
    .tlz 01;32
    .txz 01;32
    .tz 01;32
    .tzo 01;32
    .tzst 01;32
    .war 01;32
    .xz 01;32
    .z 01;32
    .Z 01;32
    .zip 01;32
    .zoo 01;32
    .zst 01;32

    ,#+--- Audio ---+
    .aac 32
    .au 32
    .flac 32
    .m4a 32
    .mid 32
    .midi 32
    .mka 32
    .mp3 32
    .mpa 32
    .mpeg 32
    .mpg 32
    .ogg 32
    .opus 32
    .ra 32
    .wav 32

    ,#+--- Customs ---+
    .3des 01;35
    .aes 01;35
    .gpg 01;35
    .pgp 01;35

    ,#+--- Documents ---+
    .doc 32
    .docx 32
    .dot 32
    .odg 32
    .odp 32
    .ods 32
    .odt 32
    .otg 32
    .otp 32
    .ots 32
    .ott 32
    .pdf 32
    .ppt 32
    .pptx 32
    .xls 32
    .xlsx 32

    ,#+--- Executables ---+
    .app 01;36
    .bat 01;36
    .btm 01;36
    .cmd 01;36
    .com 01;36
    .exe 01;36
    .reg 01;36

    ,#+--- Ignores ---+
    ,*~ 02;37
    .bak 02;37
    .BAK 02;37
    .log 02;37
    .log 02;37
    .old 02;37
    .OLD 02;37
    .orig 02;37
    .ORIG 02;37
    .swo 02;37
    .swp 02;37

    ,#+--- Images ---+
    .bmp 32
    .cgm 32
    .dl 32
    .dvi 32
    .emf 32
    .eps 32
    .gif 32
    .jpeg 32
    .jpg 32
    .JPG 32
    .mng 32
    .pbm 32
    .pcx 32
    .pgm 32
    .png 32
    .PNG 32
    .ppm 32
    .pps 32
    .ppsx 32
    .ps 32
    .svg 32
    .svgz 32
    .tga 32
    .tif 32
    .tiff 32
    .xbm 32
    .xcf 32
    .xpm 32
    .xwd 32
    .xwd 32
    .yuv 32

    ,#+--- Video ---+
    .anx 32
    .asf 32
    .avi 32
    .axv 32
    .flc 32
    .fli 32
    .flv 32
    .gl 32
    .m2v 32
    .m4v 32
    .mkv 32
    .mov 32
    .MOV 32
    .mp4 32
    .mpeg 32
    .mpg 32
    .nuv 32
    .ogm 32
    .ogv 32
    .ogx 32
    .qt 32
    .rm 32
    .rmvb 32
    .swf 32
    .vob 32
    .webm 32
    .wmv 32
  #+END_SRC

* =.dwm=
  :PROPERTIES:
  :header-args: :tangle ~/.dwm/autostart.sh
  :END:

  TODO make sure that the tangled file has executable bit set!

  This depends on the [[https://dwm.suckless.org/patches/autostart/][autostart]] patch!

  Prerequisite:

  #+BEGIN_SRC sh
    mkdir -p ~/.dwm/
  #+END_SRC

  Caps Lock, GTFO of my keyboard.  Very specifically run =xmodmap=
  /after/ =setxkbmap= to make sure that this sticks.  I want to blame
  Ubuntu and then Gnome for this but I don't have enough time right
  now to properly assign blame and then help to fix it.

  #+BEGIN_SRC sh
    #!/usr/bin/env bash

    cd
    setxkbmap -option caps:ctrl_modifier
    [[ -f ~/.Xmodmap ]] && xmodmap ~/.Xmodmap
    st &
  #+END_SRC

* DWM Backlight

  Gonna write a custom Go program for this like my stupid battery
  meter.

* =.Xmodmap=
  :PROPERTIES:
  :header-args: :tangle ~/.Xmodmap
  :END:

  [2019-12-27 Fri]

  Apparently the =setxkbmap= suite of tooling now conflicts with
  =xmodmap= in mysterious ways and it's a tire fire of mappings.
  Remapping keys should be easy but having at least two different ways
  to remap keys makes it difficult at best.

  Previously:

  Dumped first from =xmodmap -pke > ~/.Xmodmap=, then added [[https://wiki.archlinux.org/index.php/xmodmap#Reverse_scrolling][natural
  scrolling]].

  #+BEGIN_SRC sh
    ! "Natural" scolling, i.e., inverse scroll
    pointer     = 1 2 3 5 4 7 6 8 9 10

    ! Map right Alt to Mod3 for dwm to avoid Emacs collision
    remove Mod1 = Alt_R
    add Mod3    = Alt_R

    keycode   8 =
    keycode   9 = Escape NoSymbol Escape
    keycode  10 = 1 exclam 1 exclam
    keycode  11 = 2 at 2 at
    keycode  12 = 3 numbersign 3 numbersign
    keycode  13 = 4 dollar 4 dollar
    keycode  14 = 5 percent 5 percent
    keycode  15 = 6 asciicircum 6 asciicircum dead_circumflex dead_circumflex dead_circumflex
    keycode  16 = 7 ampersand 7 ampersand
    keycode  17 = 8 asterisk 8 asterisk
    keycode  18 = 9 parenleft 9 parenleft dead_grave NoSymbol dead_grave
    keycode  19 = 0 parenright 0 parenright
    keycode  20 = bracketleft braceleft bracketleft braceleft
    keycode  21 = bracketright braceright bracketright braceright dead_tilde NoSymbol dead_tilde
    keycode  22 = BackSpace BackSpace BackSpace BackSpace
    keycode  23 = Tab ISO_Left_Tab Tab ISO_Left_Tab
    keycode  24 = apostrophe quotedbl apostrophe quotedbl dead_acute dead_diaeresis dead_acute
    keycode  25 = comma less comma less dead_cedilla dead_caron dead_cedilla
    keycode  26 = period greater period greater dead_abovedot periodcentered dead_abovedot
    keycode  27 = p P p P
    keycode  28 = y Y y Y
    keycode  29 = f F f F
    keycode  30 = g G g G
    keycode  31 = c C c C
    keycode  32 = r R r R
    keycode  33 = l L l L
    keycode  34 = slash question slash question
    keycode  35 = equal plus equal plus
    keycode  36 = Return NoSymbol Return
    keycode  37 = Caps_Lock NoSymbol Caps_Lock
    keycode  38 = a A a A
    keycode  39 = o O o O
    keycode  40 = e E e E
    keycode  41 = u U u U
    keycode  42 = i I i I
    keycode  43 = d D d D
    keycode  44 = h H h H
    keycode  45 = t T t T
    keycode  46 = n N n N
    keycode  47 = s S s S
    keycode  48 = minus underscore minus underscore
    keycode  49 = grave asciitilde grave asciitilde dead_grave dead_tilde dead_grave
    keycode  50 = Shift_L NoSymbol Shift_L
    keycode  51 = backslash bar backslash bar
    keycode  52 = semicolon colon semicolon colon dead_ogonek dead_doubleacute dead_ogonek
    keycode  53 = q Q q Q
    keycode  54 = j J j J
    keycode  55 = k K k K
    keycode  56 = x X x X
    keycode  57 = b B b B
    keycode  58 = m M m M
    keycode  59 = w W w W
    keycode  60 = v V v V
    keycode  61 = z Z z Z
    keycode  62 = Shift_R NoSymbol Shift_R
    keycode  63 = KP_Multiply KP_Multiply KP_Multiply KP_Multiply KP_Multiply KP_Multiply XF86ClearGrab
    keycode  64 = Alt_L Meta_L Alt_L Meta_L
    keycode  65 = space NoSymbol space
    keycode  66 = Control_L NoSymbol Control_L
    keycode  67 = F1 F1 F1 F1 F1 F1 XF86Switch_VT_1
    keycode  68 = F2 F2 F2 F2 F2 F2 XF86Switch_VT_2
    keycode  69 = F3 F3 F3 F3 F3 F3 XF86Switch_VT_3
    keycode  70 = F4 F4 F4 F4 F4 F4 XF86Switch_VT_4
    keycode  71 = F5 F5 F5 F5 F5 F5 XF86Switch_VT_5
    keycode  72 = F6 F6 F6 F6 F6 F6 XF86Switch_VT_6
    keycode  73 = F7 F7 F7 F7 F7 F7 XF86Switch_VT_7
    keycode  74 = F8 F8 F8 F8 F8 F8 XF86Switch_VT_8
    keycode  75 = F9 F9 F9 F9 F9 F9 XF86Switch_VT_9
    keycode  76 = F10 F10 F10 F10 F10 F10 XF86Switch_VT_10
    keycode  77 = Num_Lock NoSymbol Num_Lock
    keycode  78 = Scroll_Lock NoSymbol Scroll_Lock
    keycode  79 = KP_Home KP_7 KP_Home KP_7
    keycode  80 = KP_Up KP_8 KP_Up KP_8
    keycode  81 = KP_Prior KP_9 KP_Prior KP_9
    keycode  82 = KP_Subtract KP_Subtract KP_Subtract KP_Subtract KP_Subtract KP_Subtract XF86Prev_VMode
    keycode  83 = KP_Left KP_4 KP_Left KP_4
    keycode  84 = KP_Begin KP_5 KP_Begin KP_5
    keycode  85 = KP_Right KP_6 KP_Right KP_6
    keycode  86 = KP_Add KP_Add KP_Add KP_Add KP_Add KP_Add XF86Next_VMode
    keycode  87 = KP_End KP_1 KP_End KP_1
    keycode  88 = KP_Down KP_2 KP_Down KP_2
    keycode  89 = KP_Next KP_3 KP_Next KP_3
    keycode  90 = KP_Insert KP_0 KP_Insert KP_0
    keycode  91 = KP_Delete KP_Decimal KP_Delete KP_Decimal
    keycode  92 = ISO_Level3_Shift NoSymbol ISO_Level3_Shift
    keycode  93 =
    keycode  94 = less greater less greater bar brokenbar bar
    keycode  95 = F11 F11 F11 F11 F11 F11 XF86Switch_VT_11
    keycode  96 = F12 F12 F12 F12 F12 F12 XF86Switch_VT_12
    keycode  97 =
    keycode  98 = Katakana NoSymbol Katakana
    keycode  99 = Hiragana NoSymbol Hiragana
    keycode 100 = Henkan_Mode NoSymbol Henkan_Mode
    keycode 101 = Hiragana_Katakana NoSymbol Hiragana_Katakana
    keycode 102 = Muhenkan NoSymbol Muhenkan
    keycode 103 =
    keycode 104 = KP_Enter NoSymbol KP_Enter
    keycode 105 = Control_R NoSymbol Control_R
    keycode 106 = KP_Divide KP_Divide KP_Divide KP_Divide KP_Divide KP_Divide XF86Ungrab
    keycode 107 = Print Sys_Req Print Sys_Req
    keycode 108 = Alt_R Meta_R Alt_R Meta_R
    keycode 109 = Linefeed NoSymbol Linefeed
    keycode 110 = Home NoSymbol Home
    keycode 111 = Up NoSymbol Up
    keycode 112 = Prior NoSymbol Prior
    keycode 113 = Left NoSymbol Left
    keycode 114 = Right NoSymbol Right
    keycode 115 = End NoSymbol End
    keycode 116 = Down NoSymbol Down
    keycode 117 = Next NoSymbol Next
    keycode 118 = Insert NoSymbol Insert
    keycode 119 = Delete NoSymbol Delete
    keycode 120 =
    keycode 121 = XF86AudioMute NoSymbol XF86AudioMute
    keycode 122 = XF86AudioLowerVolume NoSymbol XF86AudioLowerVolume
    keycode 123 = XF86AudioRaiseVolume NoSymbol XF86AudioRaiseVolume
    keycode 124 = XF86PowerOff NoSymbol XF86PowerOff
    keycode 125 = KP_Equal NoSymbol KP_Equal
    keycode 126 = plusminus NoSymbol plusminus
    keycode 127 = Pause Break Pause Break
    keycode 128 = XF86LaunchA NoSymbol XF86LaunchA
    keycode 129 = KP_Decimal KP_Decimal KP_Decimal KP_Decimal
    keycode 130 = Hangul NoSymbol Hangul
    keycode 131 = Hangul_Hanja NoSymbol Hangul_Hanja
    keycode 132 =
    keycode 133 = Super_L NoSymbol Super_L
    keycode 134 = Super_R NoSymbol Super_R
    keycode 135 = Menu NoSymbol Menu
    keycode 136 = Cancel NoSymbol Cancel
    keycode 137 = Redo NoSymbol Redo
    keycode 138 = SunProps NoSymbol SunProps
    keycode 139 = Undo NoSymbol Undo
    keycode 140 = SunFront NoSymbol SunFront
    keycode 141 = XF86Copy NoSymbol XF86Copy
    keycode 142 = XF86Open NoSymbol XF86Open
    keycode 143 = XF86Paste NoSymbol XF86Paste
    keycode 144 = Find NoSymbol Find
    keycode 145 = XF86Cut NoSymbol XF86Cut
    keycode 146 = Help NoSymbol Help
    keycode 147 = XF86MenuKB NoSymbol XF86MenuKB
    keycode 148 = XF86Calculator NoSymbol XF86Calculator
    keycode 149 =
    keycode 150 = XF86Sleep NoSymbol XF86Sleep
    keycode 151 = XF86WakeUp NoSymbol XF86WakeUp
    keycode 152 = XF86Explorer NoSymbol XF86Explorer
    keycode 153 = XF86Send NoSymbol XF86Send
    keycode 154 =
    keycode 155 = XF86Xfer NoSymbol XF86Xfer
    keycode 156 = XF86Launch1 NoSymbol XF86Launch1
    keycode 157 = XF86Launch2 NoSymbol XF86Launch2
    keycode 158 = XF86WWW NoSymbol XF86WWW
    keycode 159 = XF86DOS NoSymbol XF86DOS
    keycode 160 = XF86ScreenSaver NoSymbol XF86ScreenSaver
    keycode 161 = XF86RotateWindows NoSymbol XF86RotateWindows
    keycode 162 = XF86TaskPane NoSymbol XF86TaskPane
    keycode 163 = XF86Mail NoSymbol XF86Mail
    keycode 164 = XF86Favorites NoSymbol XF86Favorites
    keycode 165 = XF86MyComputer NoSymbol XF86MyComputer
    keycode 166 = XF86Back NoSymbol XF86Back
    keycode 167 = XF86Forward NoSymbol XF86Forward
    keycode 168 =
    keycode 169 = XF86Eject NoSymbol XF86Eject
    keycode 170 = XF86Eject XF86Eject XF86Eject XF86Eject
    keycode 171 = XF86AudioNext NoSymbol XF86AudioNext
    keycode 172 = XF86AudioPlay XF86AudioPause XF86AudioPlay XF86AudioPause
    keycode 173 = XF86AudioPrev NoSymbol XF86AudioPrev
    keycode 174 = XF86AudioStop XF86Eject XF86AudioStop XF86Eject
    keycode 175 = XF86AudioRecord NoSymbol XF86AudioRecord
    keycode 176 = XF86AudioRewind NoSymbol XF86AudioRewind
    keycode 177 = XF86Phone NoSymbol XF86Phone
    keycode 178 =
    keycode 179 = XF86Tools NoSymbol XF86Tools
    keycode 180 = XF86HomePage NoSymbol XF86HomePage
    keycode 181 = XF86Reload NoSymbol XF86Reload
    keycode 182 = XF86Close NoSymbol XF86Close
    keycode 183 =
    keycode 184 =
    keycode 185 = XF86ScrollUp NoSymbol XF86ScrollUp
    keycode 186 = XF86ScrollDown NoSymbol XF86ScrollDown
    keycode 187 = parenleft NoSymbol parenleft
    keycode 188 = parenright NoSymbol parenright
    keycode 189 = XF86New NoSymbol XF86New
    keycode 190 = Redo NoSymbol Redo
    keycode 191 = XF86Tools NoSymbol XF86Tools
    keycode 192 = XF86Launch5 NoSymbol XF86Launch5
    keycode 193 = XF86Launch6 NoSymbol XF86Launch6
    keycode 194 = XF86Launch7 NoSymbol XF86Launch7
    keycode 195 = XF86Launch8 NoSymbol XF86Launch8
    keycode 196 = XF86Launch9 NoSymbol XF86Launch9
    keycode 197 =
    keycode 198 = XF86AudioMicMute NoSymbol XF86AudioMicMute
    keycode 199 = XF86TouchpadToggle NoSymbol XF86TouchpadToggle
    keycode 200 = XF86TouchpadOn NoSymbol XF86TouchpadOn
    keycode 201 = XF86TouchpadOff NoSymbol XF86TouchpadOff
    keycode 202 =
    keycode 203 = Mode_switch NoSymbol Mode_switch
    keycode 204 = NoSymbol Alt_L NoSymbol Alt_L
    keycode 205 = NoSymbol Meta_L NoSymbol Meta_L
    keycode 206 = NoSymbol Super_L NoSymbol Super_L
    keycode 207 = NoSymbol Hyper_L NoSymbol Hyper_L
    keycode 208 = XF86AudioPlay NoSymbol XF86AudioPlay
    keycode 209 = XF86AudioPause NoSymbol XF86AudioPause
    keycode 210 = XF86Launch3 NoSymbol XF86Launch3
    keycode 211 = XF86Launch4 NoSymbol XF86Launch4
    keycode 212 = XF86LaunchB NoSymbol XF86LaunchB
    keycode 213 = XF86Suspend NoSymbol XF86Suspend
    keycode 214 = XF86Close NoSymbol XF86Close
    keycode 215 = XF86AudioPlay NoSymbol XF86AudioPlay
    keycode 216 = XF86AudioForward NoSymbol XF86AudioForward
    keycode 217 =
    keycode 218 = Print NoSymbol Print
    keycode 219 =
    keycode 220 = XF86WebCam NoSymbol XF86WebCam
    keycode 221 =
    keycode 222 =
    keycode 223 = XF86Mail NoSymbol XF86Mail
    keycode 224 = XF86Messenger NoSymbol XF86Messenger
    keycode 225 = XF86Search NoSymbol XF86Search
    keycode 226 = XF86Go NoSymbol XF86Go
    keycode 227 = XF86Finance NoSymbol XF86Finance
    keycode 228 = XF86Game NoSymbol XF86Game
    keycode 229 = XF86Shop NoSymbol XF86Shop
    keycode 230 =
    keycode 231 = Cancel NoSymbol Cancel
    keycode 232 = XF86MonBrightnessDown NoSymbol XF86MonBrightnessDown
    keycode 233 = XF86MonBrightnessUp NoSymbol XF86MonBrightnessUp
    keycode 234 = XF86AudioMedia NoSymbol XF86AudioMedia
    keycode 235 = XF86Display NoSymbol XF86Display
    keycode 236 = XF86KbdLightOnOff NoSymbol XF86KbdLightOnOff
    keycode 237 = XF86KbdBrightnessDown NoSymbol XF86KbdBrightnessDown
    keycode 238 = XF86KbdBrightnessUp NoSymbol XF86KbdBrightnessUp
    keycode 239 = XF86Send NoSymbol XF86Send
    keycode 240 = XF86Reply NoSymbol XF86Reply
    keycode 241 = XF86MailForward NoSymbol XF86MailForward
    keycode 242 = XF86Save NoSymbol XF86Save
    keycode 243 = XF86Documents NoSymbol XF86Documents
    keycode 244 = XF86Battery NoSymbol XF86Battery
    keycode 245 = XF86Bluetooth NoSymbol XF86Bluetooth
    keycode 246 = XF86WLAN NoSymbol XF86WLAN
    keycode 247 =
    keycode 248 =
    keycode 249 =
    keycode 250 =
    keycode 251 =
    keycode 252 =
    keycode 253 =
    keycode 254 = XF86WWAN NoSymbol XF86WWAN
    keycode 255 = XF86RFKill NoSymbol XF86RFKill
  #+END_SRC

* =.xinitrc=
  :PROPERTIES:
  :header-args: :tangle ~/.xinitrc
  :END:

  #+BEGIN_SRC sh
    export XDG_SESSION_TYPE=x11
    export GDK_BACKEND=x11
    exec gnome-session
    [[ -f ~/.Xmodmap ]] && xmodmap ~/.Xmodmap
  #+END_SRC

* Arch, Wayland & Sway

  Doing my best to avoid using X (see XWayland below…).

  https://wiki.archlinux.org/index.php/Sway has great info on
  configuring Sway.

** Zoom Screen Sharing

   This was a big pain in the ass.  Zoom sucks.  WebRTC was easy.

   #+BEGIN_SRC sh
     wf-recorder --muxer=v4l2 --codec=rawvideo --pixel-format=yuv420p --file=/dev/video0
   #+END_SRC

   Working on second monitor support:

   #+BEGIN_SRC sh
     wf-recorder --muxer=v4l2 --codec=rawvideo --pixel-format=yuv420p --file=/dev/video0 --geometry '1920,0 3840x1600' --device DP-2
   #+END_SRC

   This cuts off the right and left sides of my ultra-wide monitor.
   Maybe I'm doing it wrong, need to look at
   https://github.com/ammen99/wf-recorder/search?q=geometry&type=issues.

   Then tell Zoom to share the second "camera" which is just the
   virtual video loopback. I can't get any other pixel format to work
   so I'm stuck w/ =420p= but it's better than nothing.

   - https://github.com/umlaeute/v4l2loopback
   - https://github.com/ammen99/wf-recorder
   - https://hugo.barrera.io/journal/2020/06/14/zoom-screensharing-on-archlinux/

** [6/21] TODO

   - [ ] Aura as =pacman= replacement w/ AUR https://fosskers.github.io/aura/
   - [ ] https://github.com/swaywm/sway/wiki
   - [ ] https://github.com/Alexays/Waybar
   - [ ] A good list of things in this thread:
     https://www.reddit.com/r/swaywm/comments/bke1od/found_a_sway_config_that_rocks/
   - [-] Clipboards
     - [X] https://github.com/bugaevc/wl-clipboard
     - [ ] https://github.com/yory8/clipman
     - [ ] https://hack.org/mc/blog/no-more-x11.html
   - [X] Blue light
     - [X] https://gitlab.com/chinstrap/gammastep supports Wayland (a
       Redshift fork)
     - [X] [[https://blog.victormendonca.com/2018/05/14/creating-a-simple-systemd-user-service/][Automatically run]] gammastep
   - [X] X compatibility layer (this was required by Zoom but also
     makes Emacs outside of term happy)
     https://wiki.archlinux.org/index.php/Sway#Xwayland
   - [ ] See also X support page
     https://wayland.freedesktop.org/docs/html/ch05.html
   - [-] Fonts
     - [ ] https://wiki.archlinux.org/index.php/fonts#Tips_and_tricks
     - [X] https://github.com/alacritty/alacritty/wiki/Changing-the-default-font
   - [-] Bluetooth
     - [X] https://wiki.archlinux.org/index.php/Bluetooth
     - [ ] https://grimoire.science/working-with-wayland-and-sway/#bluetooth-managers
   - [X] Network time https://wiki.archlinux.org/index.php/Systemd-timesyncd
   - [X] Audio control
     - [X] =pavucontrol= for graphical volume adjustments
     - [X] https://wiki.archlinux.org/index.php/Sway#Custom_keybindings
   - [X] =brightnessctl= & special key bindings like for audio
   - [X] Rootless containers
     - [X] =podman= https://www.redhat.com/sysadmin/rootless-podman
     - [X] =buildah=
       - [X] https://github.com/containers/buildah/blob/master/docs/tutorials/01-intro.md
       - [X] https://wiki.archlinux.org/index.php/Buildah
     - [X] https://wiki.archlinux.org/index.php/Kernel_parameters#GRUB
     - [X] https://wiki.archlinux.org/index.php/Cgroups#Switching_to_cgroups_v2
     - [X] https://developers.redhat.com/blog/2019/02/21/podman-and-buildah-for-docker-users/
   - [ ] PDF https://wiki.archlinux.org/index.php/PDF,_PS_and_DjVu
   - [ ] WOB https://github.com/francma/wob
   - [ ] =showkey= for debugging keyboard codes
   - [-] Screenshots
     - [X] https://github.com/emersion/grim
     - [X] https://github.com/emersion/slurp
     - [ ] https://www.reddit.com/r/swaywm/comments/9q5a5l/taking_screenshot_with_selected_area/
   - [ ] Screen sharing
     - [ ] https://www.reddit.com/r/swaywm/comments/fiwg9a/zoom_screen_share_is_right_around_the_corner/
     - [ ] https://gitlab.com/jamedjo/gnome-dbus-emulation-wlr/blob/master/README.md
     - [ ] https://github.com/emersion/xdg-desktop-portal-wlr/pull/11
   - [ ] Notifications
     - [ ] https://github.com/emersion/mako
       - [ ] Dismiss all w/ mako https://git.sr.ht/~emersion/dotfiles/commit/3d27eae7c01f8486fa88c01fe889c75d3bd74de3
   - [ ] Printing
     - [ ] https://gorauskas.org/linux/arch/ArchPrintingSetup
     - [ ] https://wiki.archlinux.org/index.php/Packaging_Brother_printer_drivers
     - [ ] https://aur.archlinux.org/packages/brother-hl-l2380dw/
     - [ ] https://www.brother-usa.com/products/hll2350dw
     - [ ] https://www.reddit.com/r/archlinux/comments/c9xddz/help_me_figure_out_cups/

** Rootless Containers

   #+BEGIN_SRC sh
     cat /proc/cmdline
     BOOT_IMAGE=/boot/vmlinuz-linux root=UUID=848e68bc-2cf3-4532-a7ea-32fb8fa99c2d rw loglevel=3 quiet
   #+END_SRC

   Need to add =systemd.unified_cgroup_hierarchy=1= to enable mounting
   of =/sys/fs/cgroup= w/ v2.  I am running GRUB right now.

*** =k3s=

    Apparently this is screwing with =k3s=.  It fails with something
    about not being able to find memory cgroup.

    So maybe I need to add =cgroup_memory=1 cgroup_enable=memory= to
    the boot params?  I was using the AUR =k3s-bin= install w/ its
    systemd service and it was mad about this but it was running as
    =root=, too, which I really don't want to do.  I'm gonna try the
    regular install described in the Rancher docs and see what I get.

    https://rancher.com/docs/k3s/latest/en/advanced/#running-k3s-with-rootlesskit-experimental

    #+BEGIN_QUOTE
    Cgroups are not supported.
    #+END_QUOTE

    ☹

    Well, let's see WTF that manifests as:

    #+BEGIN_SRC sh
      curl -sfL https://get.k3s.io | sh -s - --write-kubeconfig-mode 644
    #+END_SRC

    Closer but now the networking is netfailing.

    [2020-09-21 Mon]

    I had to ditch =podman= and the dream of rootless containers to
    run k8s locally.  There are a bunch of in-work issues across
    =k3s=, =kind=, etc. about supporting rootless and cgroup v2 but
    it's just not working right now and this isn't my fight today.

    Looks like it's working w/ Docker...
